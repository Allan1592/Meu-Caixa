<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Meu Caixa</title>
    <link rel="stylesheet" href="style.css?v=30">
</head>
<body>
    <div class="app">
        <div class="header-novo">
            <button class="btn-circular" onclick="abrirJanelaBackup()" title="Backup">ðŸ“¤</button>
            <h1>Meu Caixa</h1>
            <button class="btn-circular" onclick="alternarTema()" title="Tema">ðŸŒ“</button>
        </div>

        <div class="card-resumo">
            <input type="month" id="mesFiltro" onchange="renderizar()">
            <div class="linha-resumo"><span>Entradas:</span> <span id="resumoEntradas" class="verde">R$ 0,00</span></div>
            <div class="linha-resumo"><span>SaÃ­das:</span> <span id="resumoSaidas" class="vermelho">R$ 0,00</span></div>
            <div class="linha-resumo total"><span>Saldo:</span> <span id="resumoSaldo">R$ 0,00</span></div>
        </div>

        <div class="formulario">
            <input type="text" id="descricao" placeholder="DescriÃ§Ã£o">
            <div class="row">
                <input type="number" id="valor" placeholder="R$ 0,00" step="0.01">
                <select id="tipo">
                    <option value="receita">Receita</option>
                    <option value="despesa" selected>Despesa</option>
                </select>
            </div>
            <div class="row">
                <input type="date" id="dataVencimento">
                <select id="recorrencia" onchange="ajustarCamposRecorrencia()">
                    <option value="unica">Ãšnica</option>
                    <option value="fixa">Fixa</option>
                    <option value="parcelada">Parcelada</option>
                </select>
            </div>
            <div id="divParcelas" style="display:none">
                <input type="number" id="numParcelas" placeholder="NÂº de parcelas" min="2" value="2">
            </div>
            <button onclick="adicionar()">Adicionar LanÃ§amento</button>
        </div>

        <div class="filtros-tipo">
            <button class="filter-btn active" onclick="filtrarTipo('todos', this)">Todos</button>
            <button class="filter-btn" onclick="filtrarTipo('receita', this)">Receitas</button>
            <button class="filter-btn" onclick="filtrarTipo('despesa', this)">Despesas</button>
        </div>

        <input type="text" id="busca" placeholder="ðŸ” Buscar lanÃ§amento..." oninput="renderizar()">
        
        <ul id="listaTransacoes" class="lista-transacoes"></ul>

        <div class="acoes-perigosas">
            <button onclick="confirmarLimpeza('mes')" class="btn-outline">Apagar este MÃªs</button>
            <button onclick="confirmarLimpeza('tudo')" class="btn-outline-vermelho">Limpar Tudo</button>
        </div>
    </div>

    <div id="modalBackup" class="modal">
        <div class="modal-content" style="max-height: 90vh; overflow-y: auto;">
            <h3 style="margin-top:0">Backup e RestauraÃ§Ã£o</h3>
            
            <p style="font-size: 12px; font-weight: bold; color: var(--primary);">1. GERAR CÃ“DIGO (PARA SALVAR):</p>
            <textarea id="textoBackup" style="width:100%; height:80px; font-size:10px;" readonly></textarea>
            <button onclick="copiarBackup()" class="btn-verde-ok" style="margin-bottom:15px;">Copiar CÃ³digo</button>

            <hr style="border: 0; border-top: 1px solid var(--border); margin: 15px 0;">

            <p style="font-size: 12px; font-weight: bold; color: #f39c12;">2. COLAR CÃ“DIGO (PARA RESTAURAR):</p>
            <textarea id="textoImportar" style="width:100%; height:80px; font-size:10px; background: #fffde7;" placeholder="Cole o cÃ³digo aqui..."></textarea>
            <button onclick="importarBackup()" style="background: #f39c12; color: white;">Restaurar Dados</button>

            <button onclick="fecharModal('modalBackup')" class="btn-cinza" style="margin-top:15px; width: 100%;">Fechar</button>
        </div>
    </div>

    <div id="modalConfirm" class="modal"><div class="modal-content">
        <h3>AtenÃ§Ã£o</h3>
        <p id="msgConfirm"></p>
        <div id="botoesExclusaoSimples" class="modal-buttons">
            <button onclick="fecharModal('modalConfirm')" class="btn-cinza">Cancelar</button>
            <button id="btnConfirmarSimples" class="btn-vermelho">Confirmar</button>
        </div>
        <div id="botoesExclusaoGrupo" class="modal-buttons" style="display:none; flex-direction: column; gap: 8px;">
            <button id="btnExcluirUm" class="btn-vermelho">Apenas esta</button>
            <button id="btnExcluirTodos" class="btn-vermelho" style="background:#c0392b !important">Todas as parcelas</button>
            <button onclick="fecharModal('modalConfirm')" class="btn-cinza">Voltar</button>
        </div>
    </div></div>

    <div id="modalEdit" class="modal"><div class="modal-content">
        <h3>Editar</h3>
        <input type="text" id="editDescricao">
        <input type="number" id="editValor" step="0.01">
        <input type="date" id="editData">
        <div class="modal-buttons">
            <button onclick="fecharModal('modalEdit')" class="btn-cinza">Sair</button>
            <button id="btnConfirmarEdicao" class="btn-verde-ok">Salvar</button>
        </div>
    </div></div>

    <script src="dashboard.js?v=30"></script>
</body>
</html>
